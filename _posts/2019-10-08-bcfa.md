---
layout: post
title: Bayesian confirmatory factor analysis
date: 2019-10-08
has_comments: true
has_code: true
has_math: true
include_references: true
references:
 - Spearman1904a
 - Bollen1989a
 - Jöreskog1969a
---

Factor analysis tries to explain the relationships between observed variables within a data set in terms of a smaller
number of unobserved variables. Observed variables are variously called _manifest variables_, _indicators_, or _items_,
whereas latent variables are called _factors_. When researchers talk or write about factor analysis, most of the time
they mean _exploratory factor analysis_ (EFA; [Spearman, 1904](#Spearman1904a)), a collection of statistical techniques
whose goal is to generate a factor solution from the data. A second, less common form of factor analysis is 
_confirmatory factor analysis_ (CFA; [Jöreskog, 1969](Jöreskog1969a)). In contrast to EFA, in CFA the factor solution is
specified beforehand. The factor solution may come from theory, previous work, or perhaps an EFA of the same data. CFA
is a special case of _structural equation modeling_ (SEM; [Bollen, 1989](Bollen1989a)).

Here, I describe my first attempt to implement Bayesian CFA. This turned out to be trickier than I had anticipated. At
the time of writing, I’ve successfully fitted some basic models to a well-known data set, and found similar results to
those published in a previous study. These models are missing some common CFA features, but overall, I think I’m on the
right path and that my progress is worth sharing.

## Basic CFA model

The input to CFA is typically a matrix of raw data where rows are independent cases and columns are items. This matrix 
is commonly denoted by $$\boldsymbol{Y}$$ and can be said to be $$n \times p$$, where $$n$$ is the number of cases and
$$p$$ is the number of items. Additionally, the user must specifiy $$m$$, the number of factors, and the paths, or
which items load are related to which factors. (Path specification is one of the tricky bits of CFA I alluded to
earlier.) In basic CFA, the data are assumed to be multivariate normal,

$$
$$\boldsymbol{Y}$$\sim\mathrm{Normal}
$$


It is denoted by
$$\boldsymbol{Y}=\left[\boldsymbol{y}_0,\boldsymbol{y}_1,\dots\boldsymbol{y}_p\right]$$, where
$$\boldsymbol{y}_i$$ is an $$n \times 1$$ matrix containing all the data from the $$i$$th item. The first step in
basic CFA is to construct a so-called _measurement model_,

$$\boldsymbol{y}_i = \nu_i + \boldsymbol{\Lambda}\boldsymbol{\eta}_i + \epsilon_i\textrm{,}$$

where $$\boldsymbol{\nu}=\left[\nu_0,\nu_1\dots\nu_p\right]^\textrm{T}$$ is a $$p \times 1$$ matrix of item intercepts, 
$$\boldsymbol{\Lambda}$$ is a $$p \times m$$ matrix containing factor loadings,
$$\boldsymbol{H}=\left[\boldsymbol{\eta}_0,\boldsymbol{\eta}_1\dots\boldsymbol{\eta}_n\right]^\textrm{T}$$ 


is a $$m \timesand
$$\boldsymbol{\epsilon}=\left[\epsilon_0,\epsilon_1\dots\epsilon_p\right]^\textrm{T}$$ is a $$p \times 1$$ matrix of
item residuals.


