---
layout: post
title: Bayesian confirmatory factor analysis
date: 2019-10-08
has_comments: true
has_code: true
has_math: true
include_references: true
references:
 - Spearman1904a
 - Bollen1989a
 - Jöreskog1969a
---

Factor analysis tries to explain the structure of correlations within a multivariate data set in terms of latent
variables called _factors_. There are two distinct kinds of factor analysis. The first and more common kind is
_exploratory factor analysis_ (EFA), which attempts to find the number of factors and estimate factor loadings
(regression coefficients between factors and observed variables) in a data-driven manner ([Spearman,
1904](#Spearman1904a)). The less common form is _confirmatory factor analysis_ (CFA), which tries to evaluate an assumed
factor solution ([Jöreskog, 1969](Jöreskog1969a)). CFA is a special case of _structural equation modeling_ (SEM;
[Bollen, 1989](Bollen1989a)).

Here, I describe my first attempts to implement Bayesian CFA. This turned out to be trickier than I had anticipated. At
the time of writing, I’ve successfully fitted some basic models to a well-known data set, and found similar results to
those published in a previous study. These models are missing some common CFA features, but overall, I think I’m on the
right path and my progress is worth sharing.

## Basic model

The input to CFA is typically a matrix of raw data where rows are independent cases and columns are items (sometimes
alternatively called manifest variables or indicators). This matrix has shape $$n \times p$$, where $$n$$ is the
number of cases and $$p$$ is the number of items. It is denoted by
$$\boldsymbol{Y}=\left[\boldsymbol{y}_0,\boldsymbol{y}_1,\dots\boldsymbol{y}_p\right]$$, where
$$\boldsymbol{y}_i$$ is an $$n \times 1$$ matrix containing all the data from the $$i$$th item. The first step in
basic CFA is to construct a so-called _measurement model_,

$$\boldsymbol{y}_i = \nu_i + \boldsymbol{\Lambda}\boldsymbol{\eta}_i + \epsilon_i\textrm{,}$$

where $$\boldsymbol{\nu}=\left[\nu_0,\nu_1\dots\nu_p\right]^\textrm{T}$$ is a $$p \times 1$$ matrix of item intercepts, 
$$\boldsymbol{\Lambda}$$ is a $$p \times m$$ matrix containing factor loadings,
$$\boldsymbol{H}=\left[\boldsymbol{\eta}_0,\boldsymbol{\eta}_1\dots\boldsymbol{\eta}_n\right]^\textrm{T}$$ 


is a $$m \timesand
$$\boldsymbol{\epsilon}=\left[\epsilon_0,\epsilon_1\dots\epsilon_p\right]^\textrm{T}$$ is a $$p \times 1$$ matrix of
item residuals.


